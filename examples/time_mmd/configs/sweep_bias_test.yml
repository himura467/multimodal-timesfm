# WandB Sweep Configuration for Testing Bias Hypothesis in Fusion Layer
# This configuration tests whether bias in the fully connected projection layer is necessary
# Uses Climate as validation, Energy as test, and all others as training

# Sweep method: bayes for efficient hyperparameter optimization
method: bayes

# Metric to optimize (test MSE on Energy dataset)
metric:
  name: test_mse
  goal: minimize

# Hyperparameter search space
parameters:
  # Main parameter: test with and without bias
  use_bias:
    values: [true, false]

  # Learning rate
  learning_rate:
    distribution: log_uniform_values
    min: 1e-5
    max: 1e-2

  # Weight decay (L2 regularization)
  weight_decay:
    distribution: log_uniform_values
    min: 1e-4
    max: 1e-1

  # Batch size
  batch_size:
    values: [2, 4, 8, 16]

  # Gradient accumulation steps
  gradient_accumulation_steps:
    values: [1, 2, 4, 8]

  # Number of training epochs
  num_epochs:
    values: [5, 10, 15, 20]
